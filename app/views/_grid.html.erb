<% current_user = (controller.respond_to?(:current_user) ? controller.current_user : nil) -%>
<div id='grid_<%= grid.name %>' class='grid_container' style='<%= grid.styles %>'>
  <div class='grid-header'>
    <%= grid.toolbar.render %>
    <h2><%= grid.title %></h2>
  </div>
  <div class='grid'></div>
  <div class='pager'></div>
  <% 
  if controller.respond_to?(:before_render_grid)
    before_render_grid = controller.before_render_grid(grid, params) 
    before_render_grid.call(grid, params)
  end 
  -%>
  <script type='text/javascript'>
    gridManager.createNewGrid('<%= grid.name.to_s.html_safe %>', '<%= grid.path.html_safe + ".json?" + request.query_parameters.to_query %>', <%= grid.javascript_column_model.html_safe %>, <%= grid.states_for_user(current_user).html_safe %>, <%= grid.get_actions.to_s.html_safe -%>);
  </script>
</div>

<!-- Create form -->
<%= render '/grid_form', :grid => grid %>


